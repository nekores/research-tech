<template>
    <div :class="question.cssClasses.root">
        <input v-if="!question.isReadOnly" type="file" :id="question.inputId" @change="doChange" v-bind:aria-label="question.locTitle.renderedHtml"/>
        <input type="text" readonly :class="getPlaceholderClass()" :placeholder="question.title" />
        <div>
            <img v-show="question.previewValue" :src="question.value" :height="question.imageHeight" :width="question.imageWidth" alt="File preview"/>
        </div>
    </div>
</template>

<script lang="ts">
    import Vue from 'vue'
    import {Component, Prop} from 'vue-property-decorator'
    import {default as Question} from './question'
    import {QuestionFileModel} from '../question_file'

    @Component
    export default class File extends Question<QuestionFileModel> {
        doChange (e) {
            var src = e.target || e.srcElement;
            if (!window["FileReader"]) return;
            if (!src || !src.files || src.files.length < 1) return;
            this.question.loadFile(src.files[0]);
        }
        getPlaceholderClass() {
            return "form-control " + this.question.cssClasses.placeholderInput;
        }
    }
    Vue.component("survey-file", File)
</script>
